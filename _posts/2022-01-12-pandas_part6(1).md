---
layout: single
title:  "PART 6. 데이터프레임의 다양한 응용 (1)"
categories: coding
tag: [python, blog, pandas]
toc: true
author_profile: false
---

<head>
  <style>
    table.dataframe {
      white-space: normal;
      width: 100%;
      height: 240px;
      display: block;
      overflow: auto;
      font-family: Arial, sans-serif;
      font-size: 0.7rem;
      line-height: 20px;
      text-align: center;
      border: 0px !important;
    }

    table.dataframe th {
      text-align: center;
      font-weight: bold;
      padding: 8px;
    }

    table.dataframe td {
      text-align: center;
      padding: 8px;
    }

    table.dataframe tr:hover {
      background: #b8d1f3; 
    }

    .output_prompt {
      overflow: auto;
      font-size: 0.9rem;
      line-height: 1.45;
      border-radius: 0.3rem;
      -webkit-overflow-scrolling: touch;
      padding: 0.8rem;
      margin-top: 0;
      margin-bottom: 15px;
      font: 1rem Consolas, "Liberation Mono", Menlo, Courier, monospace;
      color: $code-text-color;
      border: solid 1px $border-color;
      border-radius: 0.3rem;
      word-break: normal;
      white-space: pre;
    }

  .dataframe tbody tr th:only-of-type {
      vertical-align: middle;
  }

  .dataframe tbody tr th {
      vertical-align: top;
  }

  .dataframe thead th {
      text-align: center !important;
      padding: 8px;
  }

  .page__content p {
      margin: 0 0 0px !important;
  }

  .page__content p > strong {
    font-size: 0.8rem !important;
  }

  </style>
</head>






# PART6 데이터프레임의 다양한 응용


## 1. 함수 매핑  
* 함수 매핑 : Series 또는 DateFrame의 **개별 원소를 특정 함수에 일대일 대응**시키는 과정  
* 사용자가 직접 만든 함수(lambda 함수 포함)을 적용할 수 있어 복잡한 연산을 판다스 객체에 적용O  
<br>
  

### <1> 개별 원소에 함수 매핑

* Series 원소에 함수 매핑


```python
import seaborn as sns
titanic = sns.load_dataset('titanic')
df = titanic.loc[:, ['age', 'fare']]
df['ten']=10
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>fare</th>
      <th>ten</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22.0</td>
      <td>7.2500</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>38.0</td>
      <td>71.2833</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>26.0</td>
      <td>7.9250</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>35.0</td>
      <td>53.1000</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>35.0</td>
      <td>8.0500</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 사용자 함수 정의
def add_10(n):
    return n+10

def add_two_obj(a,b):
    return a+b
```

##### apply() : 매핑 함수에 모든 원소를 하나씩 입력하고 함수의 리턴값 돌려받음.


```python
# n = df['age']의 모든 원소
sr1 = df['age'].apply(add_10)
sr1.head()
```




    0    32.0
    1    48.0
    2    36.0
    3    45.0
    4    45.0
    Name: age, dtype: float64




```python
# a = df['age']열의 모든 원소, b=10
sr2 = df['age'].apply(add_two_obj, b=10)
sr2.head()
```




    0    32.0
    1    48.0
    2    36.0
    3    45.0
    4    45.0
    Name: age, dtype: float64



<br>

lambda 함수 활용 : 시리즈 객체에 적용  
**lambda** 매개변수: 표현식


```python
sr3 = df['age'].apply(lambda x: add_10(x))
sr3.head()
```




    0    32.0
    1    48.0
    2    36.0
    3    45.0
    4    45.0
    Name: age, dtype: float64



* DataFrame 원소에 함수 매핑
##### applymap(매핑 함수)


```python
# 데이터프레임에 add_10() 함수를 매핑 적용
df_map = df.applymap(add_10)
df_map.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>32.0</td>
      <td>17.2500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>48.0</td>
      <td>81.2833</td>
    </tr>
    <tr>
      <th>2</th>
      <td>36.0</td>
      <td>17.9250</td>
    </tr>
    <tr>
      <th>3</th>
      <td>45.0</td>
      <td>63.1000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>45.0</td>
      <td>18.0500</td>
    </tr>
  </tbody>
</table>
</div>



### <2> Series 객체에 함수 매핑
<br>


* DataFrame의 각 열에 함수 매핑
: **df.apply(매핑 함수, axis=0)**  
(axis=0 옵션의 경우, 따로 설정하지 않아도 apply()함수에 기본 적용.)


```python
# 사용자 함수 정의
def missing_value(series):   # 시리즈를 인자로 전달
    return series.isnull()   # 불린 시리즈로 반환

result = df.apply(missing_value, axis=0)
result.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>




```python
def max_min(x):
    return x.max()-x.min()

result = df.apply(max_min)
result
```




    age      79.5800
    fare    512.3292
    dtype: float64



* DataFrame의 각 행에 함수 매핑 : **df.apply(매핑 함수, axis=1)**


```python
df['ten'] = 10
df['add'] = df.apply(lambda x: add_two_obj(x['age'], x['ten']), axis=1)
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>fare</th>
      <th>ten</th>
      <th>add</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22.0</td>
      <td>7.2500</td>
      <td>10</td>
      <td>32.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>38.0</td>
      <td>71.2833</td>
      <td>10</td>
      <td>48.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>26.0</td>
      <td>7.9250</td>
      <td>10</td>
      <td>36.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>35.0</td>
      <td>53.1000</td>
      <td>10</td>
      <td>45.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>35.0</td>
      <td>8.0500</td>
      <td>10</td>
      <td>45.0</td>
    </tr>
  </tbody>
</table>
</div>



<br>
<br>

### <3> DataFrame 객체에 함수 매핑
##### df.pipe(매핑 함수)  
* 사용하는 함수가 반환하는 리턴값에 따라 pipe() 메소드가 반환하는 객체의 종류가 결정됨.  
    * DataFrame 반환하는 경우
    * Series 반환하는 경우
    * 개별 값을 반환하는 경우


```python
def missing_value(x):                  # 각 열의 NaN불린 반환
    return x.isnull()                  # df 전달 -> df 반환

def missing_count(x):                  # 각 열의 NaN개수 반환
    return missing_value(x).sum()      # df 전달 -> series 반환   

def total_number_missing(x):            # 데이터프레임의 총 NaN개수 반환
    return missing_count(x).sum()      # df 전달 -> 값 반환 
```


```python
result_df = df.pipe(missing_value)
result_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>fare</th>
      <th>ten</th>
      <th>add</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>




```python
result_series = df.pipe(missing_count)
result_series.head()
```




    age     177
    fare      0
    ten       0
    add     177
    dtype: int64




```python
result_value = df.pipe(total_number_missing)
result_value
```




    354



## 2. 열 재구성

### <1> 열 순서 변경
##### : df [ 재구성한 열 이름의 리스트 ]



```python
import seaborn as sns
titanic = sns.load_dataset('titanic')
df = titanic.loc[0:4,'survived':'age']
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>35.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 기존 열 이름
columns = list(df.columns.values)
columns
```




    ['survived', 'pclass', 'sex', 'age']




```python
# 기존 순서 알파벳 정렬
columns_sorted = sorted(columns)
df_sorted = df[columns_sorted]
df_sorted
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>pclass</th>
      <th>sex</th>
      <th>survived</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22.0</td>
      <td>3</td>
      <td>male</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>38.0</td>
      <td>1</td>
      <td>female</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>26.0</td>
      <td>3</td>
      <td>female</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>35.0</td>
      <td>1</td>
      <td>female</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>35.0</td>
      <td>3</td>
      <td>male</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 기존 순서 역순 정렬
columns_reversed = list(reversed(columns))
df_reversed = df[columns_reversed]
df_reversed
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>pclass</th>
      <th>survived</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22.0</td>
      <td>male</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>38.0</td>
      <td>female</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>26.0</td>
      <td>female</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>35.0</td>
      <td>female</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>35.0</td>
      <td>male</td>
      <td>3</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 열 이름을 사용자가 정의한 임의의 순서로 재배치
columns_customed = ['pclass', 'sex', 'age', 'survived']
df_customed = df[columns_customed]
df_customed
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>survived</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



<br>

### <2> 열 분리
* 시리즈의 문자열 리스트 인덱싱:  
##### series객체.str.get(인덱스)


```python
import pandas as pd
df = pd.read_excel('C:/Users/USER/Desktop/파이썬머신러닝 자료/part6/주가데이터.xlsx', engine='openpyxl')
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>연월일</th>
      <th>당일종가</th>
      <th>전일종가</th>
      <th>시가</th>
      <th>고가</th>
      <th>저가</th>
      <th>거래량</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2018-07-02</td>
      <td>10100</td>
      <td>600</td>
      <td>10850</td>
      <td>10900</td>
      <td>10000</td>
      <td>137977</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2018-06-29</td>
      <td>10700</td>
      <td>300</td>
      <td>10550</td>
      <td>10900</td>
      <td>9990</td>
      <td>170253</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2018-06-28</td>
      <td>10400</td>
      <td>500</td>
      <td>10900</td>
      <td>10950</td>
      <td>10150</td>
      <td>155769</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2018-06-27</td>
      <td>10900</td>
      <td>100</td>
      <td>10800</td>
      <td>11050</td>
      <td>10500</td>
      <td>133548</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2018-06-26</td>
      <td>10800</td>
      <td>350</td>
      <td>10900</td>
      <td>11000</td>
      <td>10700</td>
      <td>63039</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.dtypes
```




    연월일     datetime64[ns]
    당일종가             int64
    전일종가             int64
    시가               int64
    고가               int64
    저가               int64
    거래량              int64
    dtype: object




```python
# 연, 월, 일 데이터 분리하기
df['연월일'] = df['연월일'].astype('str') # 문자열 메소드 사용을 위해 자료형 변경
dates = df['연월일'].str.split('-')       # 문자열을 spllit() 메소드로 분리
dates.head()
```




    0    [2018, 07, 02]
    1    [2018, 06, 29]
    2    [2018, 06, 28]
    3    [2018, 06, 27]
    4    [2018, 06, 26]
    Name: 연월일, dtype: object




```python
# 분리된 정보를 각각 새로운 열에 담아 df에 추가하기
df['연'] = dates.str.get(0)    # dates 변수의 원소 리스트의 0번째 인덱스 값
df['월'] = dates.str.get(1)
df['일'] = dates.str.get(2)
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>연월일</th>
      <th>당일종가</th>
      <th>전일종가</th>
      <th>시가</th>
      <th>고가</th>
      <th>저가</th>
      <th>거래량</th>
      <th>연</th>
      <th>월</th>
      <th>일</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2018-07-02</td>
      <td>10100</td>
      <td>600</td>
      <td>10850</td>
      <td>10900</td>
      <td>10000</td>
      <td>137977</td>
      <td>2018</td>
      <td>07</td>
      <td>02</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2018-06-29</td>
      <td>10700</td>
      <td>300</td>
      <td>10550</td>
      <td>10900</td>
      <td>9990</td>
      <td>170253</td>
      <td>2018</td>
      <td>06</td>
      <td>29</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2018-06-28</td>
      <td>10400</td>
      <td>500</td>
      <td>10900</td>
      <td>10950</td>
      <td>10150</td>
      <td>155769</td>
      <td>2018</td>
      <td>06</td>
      <td>28</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2018-06-27</td>
      <td>10900</td>
      <td>100</td>
      <td>10800</td>
      <td>11050</td>
      <td>10500</td>
      <td>133548</td>
      <td>2018</td>
      <td>06</td>
      <td>27</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2018-06-26</td>
      <td>10800</td>
      <td>350</td>
      <td>10900</td>
      <td>11000</td>
      <td>10700</td>
      <td>63039</td>
      <td>2018</td>
      <td>06</td>
      <td>26</td>
    </tr>
  </tbody>
</table>
</div>



## 3. filtering
: 데이터 중에서 특정 조건식을 만족하는 원소만 따로 추출

### <1> boolean indexing


```python
# 나이가 10대인 승객만 추출
import seaborn as sns
titatnic = sns.load_dataset('titanic')
mask1 = (titanic.age>=10) & (titanic.age<20)
df_teenage = titanic.loc[mask1, :]
df_teenage.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>embarked</th>
      <th>class</th>
      <th>who</th>
      <th>adult_male</th>
      <th>deck</th>
      <th>embark_town</th>
      <th>alive</th>
      <th>alone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>2</td>
      <td>female</td>
      <td>14.0</td>
      <td>1</td>
      <td>0</td>
      <td>30.0708</td>
      <td>C</td>
      <td>Second</td>
      <td>child</td>
      <td>False</td>
      <td>NaN</td>
      <td>Cherbourg</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0</td>
      <td>3</td>
      <td>female</td>
      <td>14.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.8542</td>
      <td>S</td>
      <td>Third</td>
      <td>child</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>15.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0292</td>
      <td>Q</td>
      <td>Third</td>
      <td>child</td>
      <td>False</td>
      <td>NaN</td>
      <td>Queenstown</td>
      <td>yes</td>
      <td>True</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0</td>
      <td>1</td>
      <td>male</td>
      <td>19.0</td>
      <td>3</td>
      <td>2</td>
      <td>263.0000</td>
      <td>S</td>
      <td>First</td>
      <td>man</td>
      <td>True</td>
      <td>C</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>38</th>
      <td>0</td>
      <td>3</td>
      <td>female</td>
      <td>18.0</td>
      <td>2</td>
      <td>0</td>
      <td>18.0000</td>
      <td>S</td>
      <td>Third</td>
      <td>woman</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 나이가 10세 미만이고 여성인 승객만 따로 선택
mask2 = (titanic.age<10)&(titanic.sex=='female')
df_female_under10 = titanic.loc[mask2, :]
df_female_under10.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>embarked</th>
      <th>class</th>
      <th>who</th>
      <th>adult_male</th>
      <th>deck</th>
      <th>embark_town</th>
      <th>alive</th>
      <th>alone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>4.0</td>
      <td>1</td>
      <td>1</td>
      <td>16.7000</td>
      <td>S</td>
      <td>Third</td>
      <td>child</td>
      <td>False</td>
      <td>G</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <th>24</th>
      <td>0</td>
      <td>3</td>
      <td>female</td>
      <td>8.0</td>
      <td>3</td>
      <td>1</td>
      <td>21.0750</td>
      <td>S</td>
      <td>Third</td>
      <td>child</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>43</th>
      <td>1</td>
      <td>2</td>
      <td>female</td>
      <td>3.0</td>
      <td>1</td>
      <td>2</td>
      <td>41.5792</td>
      <td>C</td>
      <td>Second</td>
      <td>child</td>
      <td>False</td>
      <td>NaN</td>
      <td>Cherbourg</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <th>58</th>
      <td>1</td>
      <td>2</td>
      <td>female</td>
      <td>5.0</td>
      <td>1</td>
      <td>2</td>
      <td>27.7500</td>
      <td>S</td>
      <td>Second</td>
      <td>child</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <th>119</th>
      <td>0</td>
      <td>3</td>
      <td>female</td>
      <td>2.0</td>
      <td>4</td>
      <td>2</td>
      <td>31.2750</td>
      <td>S</td>
      <td>Third</td>
      <td>child</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 나이가 10세 미만 또는 60 이상인 승객의 age, sex, alone 열만 선택
mask3 = (titanic.age<10)|(titanic.age>=60)
df_age_10_60 = titanic.loc[mask3,['age', 'sex', 'alone']]
df_age_10_60.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>alone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>2.0</td>
      <td>male</td>
      <td>False</td>
    </tr>
    <tr>
      <th>10</th>
      <td>4.0</td>
      <td>female</td>
      <td>False</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2.0</td>
      <td>male</td>
      <td>False</td>
    </tr>
    <tr>
      <th>24</th>
      <td>8.0</td>
      <td>female</td>
      <td>False</td>
    </tr>
    <tr>
      <th>33</th>
      <td>66.0</td>
      <td>male</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>



### <2> isin() method 활용
* isin() 메소드를 활용한 filtering:
    ##### df.isin(추출값의 리스트)  
    : 특정 값을 가진 행들을 따로 추출


```python
import seaborn as sns
import pandas as pd
titanic = sns.load_dataset('titanic')
titanic
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>embarked</th>
      <th>class</th>
      <th>who</th>
      <th>adult_male</th>
      <th>deck</th>
      <th>embark_town</th>
      <th>alive</th>
      <th>alone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.2500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>71.2833</td>
      <td>C</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Cherbourg</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.9250</td>
      <td>S</td>
      <td>Third</td>
      <td>woman</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>53.1000</td>
      <td>S</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>886</th>
      <td>0</td>
      <td>2</td>
      <td>male</td>
      <td>27.0</td>
      <td>0</td>
      <td>0</td>
      <td>13.0000</td>
      <td>S</td>
      <td>Second</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
    </tr>
    <tr>
      <th>887</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>19.0</td>
      <td>0</td>
      <td>0</td>
      <td>30.0000</td>
      <td>S</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>B</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>True</td>
    </tr>
    <tr>
      <th>888</th>
      <td>0</td>
      <td>3</td>
      <td>female</td>
      <td>NaN</td>
      <td>1</td>
      <td>2</td>
      <td>23.4500</td>
      <td>S</td>
      <td>Third</td>
      <td>woman</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>889</th>
      <td>1</td>
      <td>1</td>
      <td>male</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>30.0000</td>
      <td>C</td>
      <td>First</td>
      <td>man</td>
      <td>True</td>
      <td>C</td>
      <td>Cherbourg</td>
      <td>yes</td>
      <td>True</td>
    </tr>
    <tr>
      <th>890</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>32.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.7500</td>
      <td>Q</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Queenstown</td>
      <td>no</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
<p>891 rows × 15 columns</p>
</div>




```python
# IPython 디스플레이 설정 변경 - 출력할 최대 열의 개수
pd.set_option('display.max_columns', 10)

# 함께 탑승한 형제 또는 배우자의 수가 3,4,5인 승객만 따로 추출 - 불린 인덱싱
mask3 = titanic['sibsp'] == 3
mask4 = titanic['sibsp'] == 4
mask5 = titanic['sibsp'] == 5

df_boolean = titanic[mask3 | mask4 | mask5]
df_boolean.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>...</th>
      <th>adult_male</th>
      <th>deck</th>
      <th>embark_town</th>
      <th>alive</th>
      <th>alone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>2.0</td>
      <td>3</td>
      <td>...</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>2.0</td>
      <td>4</td>
      <td>...</td>
      <td>False</td>
      <td>NaN</td>
      <td>Queenstown</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>24</th>
      <td>0</td>
      <td>3</td>
      <td>female</td>
      <td>8.0</td>
      <td>3</td>
      <td>...</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0</td>
      <td>1</td>
      <td>male</td>
      <td>19.0</td>
      <td>3</td>
      <td>...</td>
      <td>True</td>
      <td>C</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>50</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>7.0</td>
      <td>4</td>
      <td>...</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 15 columns</p>
</div>




```python
# isin() 메소드로 동일한 조건으로 추출
isin_filter = titanic['sibsp'].isin([3,4,5])
df_isin = titanic[isin_filter]
df_isin.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>...</th>
      <th>adult_male</th>
      <th>deck</th>
      <th>embark_town</th>
      <th>alive</th>
      <th>alone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>2.0</td>
      <td>3</td>
      <td>...</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>2.0</td>
      <td>4</td>
      <td>...</td>
      <td>False</td>
      <td>NaN</td>
      <td>Queenstown</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>24</th>
      <td>0</td>
      <td>3</td>
      <td>female</td>
      <td>8.0</td>
      <td>3</td>
      <td>...</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0</td>
      <td>1</td>
      <td>male</td>
      <td>19.0</td>
      <td>3</td>
      <td>...</td>
      <td>True</td>
      <td>C</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>50</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>7.0</td>
      <td>4</td>
      <td>...</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 15 columns</p>
</div>



# 4. DataFrame 합치기

## <1> DataFrame 연결 - concat()
##### pd.concat(데이터프레임의 리스트)


```python
import pandas as pd

df1 = pd.DataFrame({'a' : ['a0', 'a1', 'a2', 'a3'],
                    'b' : ['b0', 'b1', 'b2', 'b3'],
                    'c' : ['c0', 'c1', 'c2', 'c3']}, 
                    index = [0,1,2,3])

df2 = pd.DataFrame({'a' : ['a2', 'a3', 'a4', 'a5'],
                    'b' : ['b2', 'b3', 'b4', 'b5'],
                    'c' : ['c2', 'c3', 'c4', 'c5'],
                    'd' : ['d2', 'd3', 'd4' ,'d5']}, 
                    index = [2,3,4,5])
```


```python
df1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a0</td>
      <td>b0</td>
      <td>c0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a1</td>
      <td>b1</td>
      <td>c1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a2</td>
      <td>b2</td>
      <td>c2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a3</td>
      <td>b3</td>
      <td>c3</td>
    </tr>
  </tbody>
</table>
</div>




```python
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>a2</td>
      <td>b2</td>
      <td>c2</td>
      <td>d2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a3</td>
      <td>b3</td>
      <td>c3</td>
      <td>d3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a4</td>
      <td>b4</td>
      <td>c4</td>
      <td>d4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>a5</td>
      <td>b5</td>
      <td>c5</td>
      <td>d5</td>
    </tr>
  </tbody>
</table>
</div>




```python
result = pd.concat([df1, df2])
result
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a0</td>
      <td>b0</td>
      <td>c0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a1</td>
      <td>b1</td>
      <td>c1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a2</td>
      <td>b2</td>
      <td>c2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a3</td>
      <td>b3</td>
      <td>c3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a2</td>
      <td>b2</td>
      <td>c2</td>
      <td>d2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a3</td>
      <td>b3</td>
      <td>c3</td>
      <td>d3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a4</td>
      <td>b4</td>
      <td>c4</td>
      <td>d4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>a5</td>
      <td>b5</td>
      <td>c5</td>
      <td>d5</td>
    </tr>
  </tbody>
</table>
</div>



* ignore_index = True 옵션 : 기존 행 인덱스 무시, 새로운 행 인덱스 설정
<br>

* axis=0 : 위아래 행 방향 (기본값)
* axis=1 : 좌우 열 방향 

<br>

* join='outer': 합집합 (기본값)
* join='inner': 교집합


```python
result2 = pd.concat([df1, df2], ignore_index=True)
result2      # 정수형 위치 인덱스(0~7범위) 새롭게 설정
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a0</td>
      <td>b0</td>
      <td>c0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a1</td>
      <td>b1</td>
      <td>c1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a2</td>
      <td>b2</td>
      <td>c2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a3</td>
      <td>b3</td>
      <td>c3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a2</td>
      <td>b2</td>
      <td>c2</td>
      <td>d2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>a3</td>
      <td>b3</td>
      <td>c3</td>
      <td>d3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>a4</td>
      <td>b4</td>
      <td>c4</td>
      <td>d4</td>
    </tr>
    <tr>
      <th>7</th>
      <td>a5</td>
      <td>b5</td>
      <td>c5</td>
      <td>d5</td>
    </tr>
  </tbody>
</table>
</div>




```python
# axis=1 : 좌우 열 방향으로 연결
result3 = pd.concat([df1, df2], axis=1)
result3
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a0</td>
      <td>b0</td>
      <td>c0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a1</td>
      <td>b1</td>
      <td>c1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a2</td>
      <td>b2</td>
      <td>c2</td>
      <td>a2</td>
      <td>b2</td>
      <td>c2</td>
      <td>d2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a3</td>
      <td>b3</td>
      <td>c3</td>
      <td>a3</td>
      <td>b3</td>
      <td>c3</td>
      <td>d3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>a4</td>
      <td>b4</td>
      <td>c4</td>
      <td>d4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>a5</td>
      <td>b5</td>
      <td>c5</td>
      <td>d5</td>
    </tr>
  </tbody>
</table>
</div>




```python
# join='inner' 옵션 적용하기(교집합)
result4 = pd.concat([df1, df2], axis=1, join='inner')
result4
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>a2</td>
      <td>b2</td>
      <td>c2</td>
      <td>a2</td>
      <td>b2</td>
      <td>c2</td>
      <td>d2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a3</td>
      <td>b3</td>
      <td>c3</td>
      <td>a3</td>
      <td>b3</td>
      <td>c3</td>
      <td>d3</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Series 만들기
sr1 = pd.Series(['e0', 'e1', 'e2', 'e3'], name='e')
sr2 = pd.Series(['f0', 'f1', 'f2'], name='f', index=[3,4,5])
sr3 = pd.Series(['g0', 'g1', 'g2', 'g3'], name='g')
```


```python
result = pd.concat([df1, sr1], axis=1)
result
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a0</td>
      <td>b0</td>
      <td>c0</td>
      <td>e0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a1</td>
      <td>b1</td>
      <td>c1</td>
      <td>e1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a2</td>
      <td>b2</td>
      <td>c2</td>
      <td>e2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a3</td>
      <td>b3</td>
      <td>c3</td>
      <td>e3</td>
    </tr>
  </tbody>
</table>
</div>




```python
result = pd.concat([df2, sr2], axis=1, sort=True)
result
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>f</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>a2</td>
      <td>b2</td>
      <td>c2</td>
      <td>d2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a3</td>
      <td>b3</td>
      <td>c3</td>
      <td>d3</td>
      <td>f0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a4</td>
      <td>b4</td>
      <td>c4</td>
      <td>d4</td>
      <td>f1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>a5</td>
      <td>b5</td>
      <td>c5</td>
      <td>d5</td>
      <td>f2</td>
    </tr>
  </tbody>
</table>
</div>




```python
result = pd.concat([sr1, sr3], axis=1)
result
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>e</th>
      <th>g</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>e0</td>
      <td>g0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>e1</td>
      <td>g1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>e2</td>
      <td>g2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>e3</td>
      <td>g3</td>
    </tr>
  </tbody>
</table>
</div>




```python
result2 = pd.concat([sr1, sr3], axis=0)
result2
```




    0    e0
    1    e1
    2    e2
    3    e3
    0    g0
    1    g1
    2    g2
    3    g3
    dtype: object



## <2> DataFrame 병합 - Merge()
##### : pd.merge( df_left, df_right, how='inner'/'outer', on=None)
* on=None : 기본값
* how='inner': 기본값


```python
# Ipython 디스플레이 설정 변경
pd.set_option('display.max_columns', 10)      # 출력할 최대 열의 개수
pd.set_option('display.max_colwidth', 20)     # 출력할 열의 너비
pd.set_option('display.unicode.east_asian_width', True) # 유니코드 사용 너비 조정
```


```python
df1 = pd.read_excel('C:/Users/USER/Desktop/파이썬머신러닝 자료/part6/stock price.xlsx', engine='openpyxl')
df2 = pd.read_excel('C:/Users/USER/Desktop/파이썬머신러닝 자료/part6/stock valuation.xlsx', engine='openpyxl')
```


```python
df1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>stock_name</th>
      <th>value</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>128940</td>
      <td>한미약품</td>
      <td>59385.666667</td>
      <td>421000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>130960</td>
      <td>CJ E&amp;M</td>
      <td>58540.666667</td>
      <td>98900</td>
    </tr>
    <tr>
      <th>2</th>
      <td>138250</td>
      <td>엔에스쇼핑</td>
      <td>14558.666667</td>
      <td>13200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>139480</td>
      <td>이마트</td>
      <td>239230.833333</td>
      <td>254500</td>
    </tr>
    <tr>
      <th>4</th>
      <td>142280</td>
      <td>녹십자엠에스</td>
      <td>468.833333</td>
      <td>10200</td>
    </tr>
    <tr>
      <th>5</th>
      <td>145990</td>
      <td>삼양사</td>
      <td>82750.000000</td>
      <td>82000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>185750</td>
      <td>종근당</td>
      <td>40293.666667</td>
      <td>100500</td>
    </tr>
    <tr>
      <th>7</th>
      <td>192400</td>
      <td>쿠쿠홀딩스</td>
      <td>179204.666667</td>
      <td>177500</td>
    </tr>
    <tr>
      <th>8</th>
      <td>199800</td>
      <td>툴젠</td>
      <td>-2514.333333</td>
      <td>115400</td>
    </tr>
    <tr>
      <th>9</th>
      <td>204210</td>
      <td>모두투어리츠</td>
      <td>3093.333333</td>
      <td>3475</td>
    </tr>
  </tbody>
</table>
</div>




```python
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>eps</th>
      <th>bps</th>
      <th>per</th>
      <th>pbr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>130960</td>
      <td>CJ E&amp;M</td>
      <td>6301.333333</td>
      <td>54068</td>
      <td>15.695091</td>
      <td>1.829178</td>
    </tr>
    <tr>
      <th>1</th>
      <td>136480</td>
      <td>하림</td>
      <td>274.166667</td>
      <td>3551</td>
      <td>11.489362</td>
      <td>0.887074</td>
    </tr>
    <tr>
      <th>2</th>
      <td>138040</td>
      <td>메리츠금융지주</td>
      <td>2122.333333</td>
      <td>14894</td>
      <td>6.313806</td>
      <td>0.899691</td>
    </tr>
    <tr>
      <th>3</th>
      <td>139480</td>
      <td>이마트</td>
      <td>18268.166667</td>
      <td>295780</td>
      <td>13.931338</td>
      <td>0.860437</td>
    </tr>
    <tr>
      <th>4</th>
      <td>145990</td>
      <td>삼양사</td>
      <td>5741.000000</td>
      <td>108090</td>
      <td>14.283226</td>
      <td>0.758627</td>
    </tr>
    <tr>
      <th>5</th>
      <td>161390</td>
      <td>한국타이어</td>
      <td>5648.500000</td>
      <td>51341</td>
      <td>7.453306</td>
      <td>0.820007</td>
    </tr>
    <tr>
      <th>6</th>
      <td>181710</td>
      <td>NHN엔터테인먼트</td>
      <td>2110.166667</td>
      <td>78434</td>
      <td>30.755864</td>
      <td>0.827447</td>
    </tr>
    <tr>
      <th>7</th>
      <td>185750</td>
      <td>종근당</td>
      <td>3990.333333</td>
      <td>40684</td>
      <td>25.185866</td>
      <td>2.470259</td>
    </tr>
    <tr>
      <th>8</th>
      <td>204210</td>
      <td>모두투어리츠</td>
      <td>85.166667</td>
      <td>5335</td>
      <td>40.802348</td>
      <td>0.651359</td>
    </tr>
    <tr>
      <th>9</th>
      <td>207940</td>
      <td>삼성바이오로직스</td>
      <td>4644.166667</td>
      <td>60099</td>
      <td>89.790059</td>
      <td>6.938551</td>
    </tr>
  </tbody>
</table>
</div>



* on=None 옵션 : 공통으로 속하는 모든 열을 기준키로 병합


```python
# 데이터프레임 합치기 - 교집합
merge_inner = pd.merge(df1, df2)
merge_inner
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>stock_name</th>
      <th>value</th>
      <th>price</th>
      <th>name</th>
      <th>eps</th>
      <th>bps</th>
      <th>per</th>
      <th>pbr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>130960</td>
      <td>CJ E&amp;M</td>
      <td>58540.666667</td>
      <td>98900</td>
      <td>CJ E&amp;M</td>
      <td>6301.333333</td>
      <td>54068</td>
      <td>15.695091</td>
      <td>1.829178</td>
    </tr>
    <tr>
      <th>1</th>
      <td>139480</td>
      <td>이마트</td>
      <td>239230.833333</td>
      <td>254500</td>
      <td>이마트</td>
      <td>18268.166667</td>
      <td>295780</td>
      <td>13.931338</td>
      <td>0.860437</td>
    </tr>
    <tr>
      <th>2</th>
      <td>145990</td>
      <td>삼양사</td>
      <td>82750.000000</td>
      <td>82000</td>
      <td>삼양사</td>
      <td>5741.000000</td>
      <td>108090</td>
      <td>14.283226</td>
      <td>0.758627</td>
    </tr>
    <tr>
      <th>3</th>
      <td>185750</td>
      <td>종근당</td>
      <td>40293.666667</td>
      <td>100500</td>
      <td>종근당</td>
      <td>3990.333333</td>
      <td>40684</td>
      <td>25.185866</td>
      <td>2.470259</td>
    </tr>
    <tr>
      <th>4</th>
      <td>204210</td>
      <td>모두투어리츠</td>
      <td>3093.333333</td>
      <td>3475</td>
      <td>모두투어리츠</td>
      <td>85.166667</td>
      <td>5335</td>
      <td>40.802348</td>
      <td>0.651359</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 데이터프레임 합치기 - 합집합
merge_outer = pd.merge(df1,df2, how='outer', on='id')
merge_outer.head()
# 어느 한쪽이라도 데이터가 없는 열에는 NaN값이 지정된 것을 볼 수 있다!
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>stock_name</th>
      <th>value</th>
      <th>price</th>
      <th>name</th>
      <th>eps</th>
      <th>bps</th>
      <th>per</th>
      <th>pbr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>128940</td>
      <td>한미약품</td>
      <td>59385.666667</td>
      <td>421000.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>130960</td>
      <td>CJ E&amp;M</td>
      <td>58540.666667</td>
      <td>98900.0</td>
      <td>CJ E&amp;M</td>
      <td>6301.333333</td>
      <td>54068.0</td>
      <td>15.695091</td>
      <td>1.829178</td>
    </tr>
    <tr>
      <th>2</th>
      <td>138250</td>
      <td>엔에스쇼핑</td>
      <td>14558.666667</td>
      <td>13200.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>139480</td>
      <td>이마트</td>
      <td>239230.833333</td>
      <td>254500.0</td>
      <td>이마트</td>
      <td>18268.166667</td>
      <td>295780.0</td>
      <td>13.931338</td>
      <td>0.860437</td>
    </tr>
    <tr>
      <th>4</th>
      <td>142280</td>
      <td>녹십자엠에스</td>
      <td>468.833333</td>
      <td>10200.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 데이터프레임 합치기 - 왼쪽 데이터프레임 기준, 키 값 분리
# df1의 'stock_name', df2의 'name' 열을 기준으로 병합
# 기준열이 아닌 'id'의 경우 양쪽 df에 모두 존재 -> 'id_x', 'id_y' 로 구분
merge_left = pd.merge(df1, df2, how='left', left_on='stock_name', right_on='name')
merge_left.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_x</th>
      <th>stock_name</th>
      <th>value</th>
      <th>price</th>
      <th>id_y</th>
      <th>name</th>
      <th>eps</th>
      <th>bps</th>
      <th>per</th>
      <th>pbr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>128940</td>
      <td>한미약품</td>
      <td>59385.666667</td>
      <td>421000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>130960</td>
      <td>CJ E&amp;M</td>
      <td>58540.666667</td>
      <td>98900</td>
      <td>130960.0</td>
      <td>CJ E&amp;M</td>
      <td>6301.333333</td>
      <td>54068.0</td>
      <td>15.695091</td>
      <td>1.829178</td>
    </tr>
    <tr>
      <th>2</th>
      <td>138250</td>
      <td>엔에스쇼핑</td>
      <td>14558.666667</td>
      <td>13200</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>139480</td>
      <td>이마트</td>
      <td>239230.833333</td>
      <td>254500</td>
      <td>139480.0</td>
      <td>이마트</td>
      <td>18268.166667</td>
      <td>295780.0</td>
      <td>13.931338</td>
      <td>0.860437</td>
    </tr>
    <tr>
      <th>4</th>
      <td>142280</td>
      <td>녹십자엠에스</td>
      <td>468.833333</td>
      <td>10200</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 불린 인덱싱과 결합하여 원하는 데이터 찾기
price = df1[df1['price'] <50000]
price.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>stock_name</th>
      <th>value</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>138250</td>
      <td>엔에스쇼핑</td>
      <td>14558.666667</td>
      <td>13200</td>
    </tr>
    <tr>
      <th>4</th>
      <td>142280</td>
      <td>녹십자엠에스</td>
      <td>468.833333</td>
      <td>10200</td>
    </tr>
    <tr>
      <th>9</th>
      <td>204210</td>
      <td>모두투어리츠</td>
      <td>3093.333333</td>
      <td>3475</td>
    </tr>
  </tbody>
</table>
</div>




```python
value = pd.merge(price, df2)
value
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>stock_name</th>
      <th>value</th>
      <th>price</th>
      <th>name</th>
      <th>eps</th>
      <th>bps</th>
      <th>per</th>
      <th>pbr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>204210</td>
      <td>모두투어리츠</td>
      <td>3093.333333</td>
      <td>3475</td>
      <td>모두투어리츠</td>
      <td>85.166667</td>
      <td>5335</td>
      <td>40.802348</td>
      <td>0.651359</td>
    </tr>
  </tbody>
</table>
</div>



## <3> DataFrame 결합 - Join()


```python
import pandas as pd

#Ipython 디스플레이 변경 
pd.set_option('display.max_columns', 10)              # 출력할 최대 열의 개수
pd.set_option('display.max_colwidth', 20)             # 출력할 열의 너비
pd.set_option('display.unicode.east_asian_width', True) # 유니코드 사용 너비 조정

# 주식 테이블 가져와 dataframe 만들기
df1 = pd.read_excel('C:/Users/USER/Desktop/파이썬머신러닝 자료/part6/stock price.xlsx', index_col='id', engine='openpyxl')
df2 = pd.read_excel('C:/Users/USER/Desktop/파이썬머신러닝 자료/part6/stock valuation.xlsx', index_col='id', engine='openpyxl')
df3 = df1.join(df2)
df3
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stock_name</th>
      <th>value</th>
      <th>price</th>
      <th>name</th>
      <th>eps</th>
      <th>bps</th>
      <th>per</th>
      <th>pbr</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>128940</th>
      <td>한미약품</td>
      <td>59385.666667</td>
      <td>421000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>130960</th>
      <td>CJ E&amp;M</td>
      <td>58540.666667</td>
      <td>98900</td>
      <td>CJ E&amp;M</td>
      <td>6301.333333</td>
      <td>54068.0</td>
      <td>15.695091</td>
      <td>1.829178</td>
    </tr>
    <tr>
      <th>138250</th>
      <td>엔에스쇼핑</td>
      <td>14558.666667</td>
      <td>13200</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>139480</th>
      <td>이마트</td>
      <td>239230.833333</td>
      <td>254500</td>
      <td>이마트</td>
      <td>18268.166667</td>
      <td>295780.0</td>
      <td>13.931338</td>
      <td>0.860437</td>
    </tr>
    <tr>
      <th>142280</th>
      <td>녹십자엠에스</td>
      <td>468.833333</td>
      <td>10200</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>145990</th>
      <td>삼양사</td>
      <td>82750.000000</td>
      <td>82000</td>
      <td>삼양사</td>
      <td>5741.000000</td>
      <td>108090.0</td>
      <td>14.283226</td>
      <td>0.758627</td>
    </tr>
    <tr>
      <th>185750</th>
      <td>종근당</td>
      <td>40293.666667</td>
      <td>100500</td>
      <td>종근당</td>
      <td>3990.333333</td>
      <td>40684.0</td>
      <td>25.185866</td>
      <td>2.470259</td>
    </tr>
    <tr>
      <th>192400</th>
      <td>쿠쿠홀딩스</td>
      <td>179204.666667</td>
      <td>177500</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>199800</th>
      <td>툴젠</td>
      <td>-2514.333333</td>
      <td>115400</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>204210</th>
      <td>모두투어리츠</td>
      <td>3093.333333</td>
      <td>3475</td>
      <td>모두투어리츠</td>
      <td>85.166667</td>
      <td>5335.0</td>
      <td>40.802348</td>
      <td>0.651359</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 데이터프레임 결합(join) - 교집합
df4 = df1.join(df2, how='inner')
df4
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stock_name</th>
      <th>value</th>
      <th>price</th>
      <th>name</th>
      <th>eps</th>
      <th>bps</th>
      <th>per</th>
      <th>pbr</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>130960</th>
      <td>CJ E&amp;M</td>
      <td>58540.666667</td>
      <td>98900</td>
      <td>CJ E&amp;M</td>
      <td>6301.333333</td>
      <td>54068</td>
      <td>15.695091</td>
      <td>1.829178</td>
    </tr>
    <tr>
      <th>139480</th>
      <td>이마트</td>
      <td>239230.833333</td>
      <td>254500</td>
      <td>이마트</td>
      <td>18268.166667</td>
      <td>295780</td>
      <td>13.931338</td>
      <td>0.860437</td>
    </tr>
    <tr>
      <th>145990</th>
      <td>삼양사</td>
      <td>82750.000000</td>
      <td>82000</td>
      <td>삼양사</td>
      <td>5741.000000</td>
      <td>108090</td>
      <td>14.283226</td>
      <td>0.758627</td>
    </tr>
    <tr>
      <th>185750</th>
      <td>종근당</td>
      <td>40293.666667</td>
      <td>100500</td>
      <td>종근당</td>
      <td>3990.333333</td>
      <td>40684</td>
      <td>25.185866</td>
      <td>2.470259</td>
    </tr>
    <tr>
      <th>204210</th>
      <td>모두투어리츠</td>
      <td>3093.333333</td>
      <td>3475</td>
      <td>모두투어리츠</td>
      <td>85.166667</td>
      <td>5335</td>
      <td>40.802348</td>
      <td>0.651359</td>
    </tr>
  </tbody>
</table>
</div>



## 5. 그룹 연산
* 그룹 연산 : 특정 기준을 적용하여 몇 개의 그룹으로 분할하여 처리하는 것
* 데이터를 집계, 변환, 필터링하는데 효율적
    * < 1단계 > 분할(split) : 데이터를 특정 조건에 의해 분할 
    * < 2단계 > 적용(apply) : 데이터를 집계, 변환, 필터링하는데 필요한 메소드 적용
    * < 3단계 > 결합(combine) : 2단계의 처리 결과를 하나의 연산으로 결합

### <1> 1단계 - 그룹 객체 만들기( 분할 단계 )
##### df.groupby(기준이 되는 열이나 리스트)

* 1개 열을 기준으로 그룹화


```python
import pandas as pd
import seaborn as sns

titanic = sns.load_dataset('titanic')
df = titanic.loc[:, ['age', 'sex', 'class', 'fare', 'survived']]
print("승객 수 :", len(df))
print(df.head())
```

    승객 수 : 891
        age     sex  class     fare  survived
    0  22.0    male  Third   7.2500         0
    1  38.0  female  First  71.2833         1
    2  26.0  female  Third   7.9250         1
    3  35.0  female  First  53.1000         1
    4  35.0    male  Third   8.0500         0
    

class 열에는 'First', 'Second', 'Third'라는 3개의 값(keys)이 있다.  
이 3개의 값을 기준으로 891명의 승객은 3개의 그룹으로 나누어진다.



```python
grouped = df.groupby(['class'])

# 그룹 객체를 iteration으로 출력
for key, group in grouped:
    print('* key 값은 :', key)
    print('* 이 그룹의 승객 수는 :', len(group))
    print(group.head())
    print('\n')
```

    * key 값은 : First
    * 이 그룹의 승객 수는 : 216
         age     sex  class     fare  survived
    1   38.0  female  First  71.2833         1
    3   35.0  female  First  53.1000         1
    6   54.0    male  First  51.8625         0
    11  58.0  female  First  26.5500         1
    23  28.0    male  First  35.5000         1
    
    
    * key 값은 : Second
    * 이 그룹의 승객 수는 : 184
         age     sex   class     fare  survived
    9   14.0  female  Second  30.0708         1
    15  55.0  female  Second  16.0000         1
    17   NaN    male  Second  13.0000         1
    20  35.0    male  Second  26.0000         0
    21  34.0    male  Second  13.0000         1
    
    
    * key 값은 : Third
    * 이 그룹의 승객 수는 : 491
        age     sex  class     fare  survived
    0  22.0    male  Third   7.2500         0
    2  26.0  female  Third   7.9250         1
    4  35.0    male  Third   8.0500         0
    5   NaN    male  Third   8.4583         0
    7   2.0    male  Third  21.0750         0
    
    
    


```python
# 3개의 그룹별 평균값
averaged = grouped.mean()
averaged
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>fare</th>
      <th>survived</th>
    </tr>
    <tr>
      <th>class</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>First</th>
      <td>38.233441</td>
      <td>84.154687</td>
      <td>0.629630</td>
    </tr>
    <tr>
      <th>Second</th>
      <td>29.877630</td>
      <td>20.662183</td>
      <td>0.472826</td>
    </tr>
    <tr>
      <th>Third</th>
      <td>25.140620</td>
      <td>13.675550</td>
      <td>0.242363</td>
    </tr>
  </tbody>
</table>
</div>



##### get_group: 특정 그룹만 선택


```python
group3 = grouped.get_group('Third')
group3.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>class</th>
      <th>fare</th>
      <th>survived</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22.0</td>
      <td>male</td>
      <td>Third</td>
      <td>7.2500</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>26.0</td>
      <td>female</td>
      <td>Third</td>
      <td>7.9250</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>35.0</td>
      <td>male</td>
      <td>Third</td>
      <td>8.0500</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>male</td>
      <td>Third</td>
      <td>8.4583</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2.0</td>
      <td>male</td>
      <td>Third</td>
      <td>21.0750</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



<br>

* 여러 열을 기준으로 그룹화


```python
# class 열, sex열을 기준으로 분할
grouped_two = df.groupby(['class', 'sex'])

for key, group in grouped_two:
    print('* key :', key)
    print('* 이 그룹 승객 수는 :', len(group))
    print(group.head())
    print('\n')
```

    * key : ('First', 'female')
    * 이 그룹 승객 수는 : 94
         age     sex  class      fare  survived
    1   38.0  female  First   71.2833         1
    3   35.0  female  First   53.1000         1
    11  58.0  female  First   26.5500         1
    31   NaN  female  First  146.5208         1
    52  49.0  female  First   76.7292         1
    
    
    * key : ('First', 'male')
    * 이 그룹 승객 수는 : 122
         age   sex  class      fare  survived
    6   54.0  male  First   51.8625         0
    23  28.0  male  First   35.5000         1
    27  19.0  male  First  263.0000         0
    30  40.0  male  First   27.7208         0
    34  28.0  male  First   82.1708         0
    
    
    * key : ('Second', 'female')
    * 이 그룹 승객 수는 : 76
         age     sex   class     fare  survived
    9   14.0  female  Second  30.0708         1
    15  55.0  female  Second  16.0000         1
    41  27.0  female  Second  21.0000         0
    43   3.0  female  Second  41.5792         1
    53  29.0  female  Second  26.0000         1
    
    
    * key : ('Second', 'male')
    * 이 그룹 승객 수는 : 108
         age   sex   class  fare  survived
    17   NaN  male  Second  13.0         1
    20  35.0  male  Second  26.0         0
    21  34.0  male  Second  13.0         1
    33  66.0  male  Second  10.5         0
    70  32.0  male  Second  10.5         0
    
    
    * key : ('Third', 'female')
    * 이 그룹 승객 수는 : 144
         age     sex  class     fare  survived
    2   26.0  female  Third   7.9250         1
    8   27.0  female  Third  11.1333         1
    10   4.0  female  Third  16.7000         1
    14  14.0  female  Third   7.8542         0
    18  31.0  female  Third  18.0000         0
    
    
    * key : ('Third', 'male')
    * 이 그룹 승객 수는 : 347
         age   sex  class     fare  survived
    0   22.0  male  Third   7.2500         0
    4   35.0  male  Third   8.0500         0
    5    NaN  male  Third   8.4583         0
    7    2.0  male  Third  21.0750         0
    12  20.0  male  Third   8.0500         0
    
    
    

'class' 열에는 'First', 'Second', 'Third' 3개의 값  
'sex' 열에는 'female', 'male' 2개의 값  
-> 그룹화 -> 총 **6개**의 그룹


```python
average_two = grouped_two.mean()
average_two
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>age</th>
      <th>fare</th>
      <th>survived</th>
    </tr>
    <tr>
      <th>class</th>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">First</th>
      <th>female</th>
      <td>34.611765</td>
      <td>106.125798</td>
      <td>0.968085</td>
    </tr>
    <tr>
      <th>male</th>
      <td>41.281386</td>
      <td>67.226127</td>
      <td>0.368852</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Second</th>
      <th>female</th>
      <td>28.722973</td>
      <td>21.970121</td>
      <td>0.921053</td>
    </tr>
    <tr>
      <th>male</th>
      <td>30.740707</td>
      <td>19.741782</td>
      <td>0.157407</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Third</th>
      <th>female</th>
      <td>21.750000</td>
      <td>16.118810</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>male</th>
      <td>26.507589</td>
      <td>12.661633</td>
      <td>0.135447</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 특정 그룹 선택 / get_group() 이용
group3f = grouped_two.get_group(('Third', 'male'))
group3f.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>class</th>
      <th>fare</th>
      <th>survived</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22.0</td>
      <td>male</td>
      <td>Third</td>
      <td>7.2500</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>35.0</td>
      <td>male</td>
      <td>Third</td>
      <td>8.0500</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>male</td>
      <td>Third</td>
      <td>8.4583</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2.0</td>
      <td>male</td>
      <td>Third</td>
      <td>21.0750</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>20.0</td>
      <td>male</td>
      <td>Third</td>
      <td>8.0500</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



<br>

### <2>  그룹 연산 메소드(2-3단계) : 적용-결합 단계

* 데이터 집계(aggregation)


```python
# 'class' 열을 기준으로 분할
grouped = df.groupby(['class'])

# 각 그룹에 대한 모든 열의 표준편차를 집계하여 데이터프레임으로 변환
std_all = grouped.std()
std_all
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>fare</th>
      <th>survived</th>
    </tr>
    <tr>
      <th>class</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>First</th>
      <td>14.802856</td>
      <td>78.380373</td>
      <td>0.484026</td>
    </tr>
    <tr>
      <th>Second</th>
      <td>14.001077</td>
      <td>13.417399</td>
      <td>0.500623</td>
    </tr>
    <tr>
      <th>Third</th>
      <td>12.495398</td>
      <td>11.778142</td>
      <td>0.428949</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 각 그룹에 대한 fare 열의 표준편차를 집계하여 시리즈로 반환
std_fare = grouped.fare.std()
std_fare
```




    class
    First     78.380373
    Second    13.417399
    Third     11.778142
    Name: fare, dtype: float64




```python
# 그룹 객체에 agg(매핑 함수) 메소드 적용 - 사용자 정의 함수를 인자로 전달
def max_min(x):
    return x.max() - x.min()

# 각 그룹의 최댓값과 최소값의 차이를 계산하여 그룹별로 집계
agg_maxmin = grouped.agg(max_min)
agg_maxmin
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>fare</th>
      <th>survived</th>
    </tr>
    <tr>
      <th>class</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>First</th>
      <td>79.08</td>
      <td>512.3292</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Second</th>
      <td>69.33</td>
      <td>73.5000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Third</th>
      <td>73.58</td>
      <td>69.5500</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



<br>

* 모든 열에 여러 함수 매핑 : group객체.agg([함수1, 함수2...])
* 각 열마다 다른 함수 매핑 : group객체.agg({'열1': '함수1', ...})


```python
# 여러 함수를 각 열에 동일하게 적용하여 집계
agg_all = grouped.agg(['max', 'min'])
agg_all

# 각 열마다 다른 함수를 적용하여 집계
agg_dif = grouped.agg({'fare':['max', 'min'], 'age': 'mean'})
agg_dif
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">fare</th>
      <th>age</th>
    </tr>
    <tr>
      <th></th>
      <th>max</th>
      <th>min</th>
      <th>mean</th>
    </tr>
    <tr>
      <th>class</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>First</th>
      <td>512.3292</td>
      <td>0.0</td>
      <td>38.233441</td>
    </tr>
    <tr>
      <th>Second</th>
      <td>73.5000</td>
      <td>0.0</td>
      <td>29.877630</td>
    </tr>
    <tr>
      <th>Third</th>
      <td>69.5500</td>
      <td>0.0</td>
      <td>25.140620</td>
    </tr>
  </tbody>
</table>
</div>



<br>

* 그룹 연산 데이터 변환 
##### group객체.transform(매핑 함수)


```python
# 그룹별 age 열의 평균 집계 연산
age_mean = grouped.age.mean()
# 그룹별 age 열의 표준편차 집계 연산
age_std = grouped.age.std()

# 그룹 객체의 age 열을 iteration으로 z-score(표준화 점수)를 계산하여 출력
for key, group in grouped.age:
    group_zscore = (group - age_mean.loc[key])/age_std.loc[key]
    print('* origin:', key)
    print(group_zscore.head())
    print('\n')
```

    * origin: First
    1    -0.015770
    3    -0.218434
    6     1.065103
    11    1.335321
    23   -0.691315
    Name: age, dtype: float64
    
    
    * origin: Second
    9    -1.134029
    15    1.794317
    17         NaN
    20    0.365855
    21    0.294432
    Name: age, dtype: float64
    
    
    * origin: Third
    0   -0.251342
    2    0.068776
    4    0.789041
    5         NaN
    7   -1.851931
    Name: age, dtype: float64
    
    
    


```python
# z-score를 계산하는 사용자 정의 함수
def z_score(x):
    return (x-x.mean())/x.std()

# transform() 메소드를 이용하여 age열의 데이터를 z-score로 변환
age_zscore = grouped.age.transform(z_score)
print(age_zscore.loc[[1,9,0]]) # 위 출력물 그룹별 첫번쨰 값 같은 것 확인!
print('\n')
print(age_zscore.loc[1:9]) # transform ㅔ소드 반환 값10개 출력
```

    1   -0.015770
    9   -1.134029
    0   -0.251342
    Name: age, dtype: float64
    
    
    1   -0.015770
    2    0.068776
    3   -0.218434
    4    0.789041
    5         NaN
    6    1.065103
    7   -1.851931
    8    0.148805
    9   -1.134029
    Name: age, dtype: float64
    

<br>

* 그룹 객체 필터링
##### group객체.filter(조건식 함수)  
조건식이 참인 그룹만 남긴다.


```python
# 데이터 개수가 200개 이상인 그룹만을 필터링하여 데이터프레임으로 변환
# 출력: 데이터 개수가 200개 이상인 그룹은 'First', 'Third' 이므로 두 그룹 값들 출력됨.
grouped_filter = grouped.filter(lambda x: len(x)>200)
grouped_filter.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>class</th>
      <th>fare</th>
      <th>survived</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22.0</td>
      <td>male</td>
      <td>Third</td>
      <td>7.2500</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>38.0</td>
      <td>female</td>
      <td>First</td>
      <td>71.2833</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>26.0</td>
      <td>female</td>
      <td>Third</td>
      <td>7.9250</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>35.0</td>
      <td>female</td>
      <td>First</td>
      <td>53.1000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>35.0</td>
      <td>male</td>
      <td>Third</td>
      <td>8.0500</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# age열의 평균이 30보다 작은 그룹만을 필터링하여 데이터프레임으로 변환
# 출력 : 평균 나이가 30 이 안되는 그룹은 'Second', 'Third'이므로 두 그룹 값들 출력됨.
grouped_filter2 = grouped.filter(lambda x: x.age.mean()<30)
grouped_filter2.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>class</th>
      <th>fare</th>
      <th>survived</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22.0</td>
      <td>male</td>
      <td>Third</td>
      <td>7.2500</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>26.0</td>
      <td>female</td>
      <td>Third</td>
      <td>7.9250</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>35.0</td>
      <td>male</td>
      <td>Third</td>
      <td>8.0500</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>male</td>
      <td>Third</td>
      <td>8.4583</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2.0</td>
      <td>male</td>
      <td>Third</td>
      <td>21.0750</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



<br>

* 그룹 객체에 함수 매핑
##### group객체.apply(매핑 함수)  
개별 원소를 특정 함수에 일대일 매핑


```python
# 집계 : 각 그룹별 요약 통계 정보 집계
agg_grouped = grouped.apply(lambda x: x.describe())
agg_grouped
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>age</th>
      <th>fare</th>
      <th>survived</th>
    </tr>
    <tr>
      <th>class</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="8" valign="top">First</th>
      <th>count</th>
      <td>186.000000</td>
      <td>216.000000</td>
      <td>216.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>38.233441</td>
      <td>84.154687</td>
      <td>0.629630</td>
    </tr>
    <tr>
      <th>std</th>
      <td>14.802856</td>
      <td>78.380373</td>
      <td>0.484026</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.920000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>27.000000</td>
      <td>30.923950</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>37.000000</td>
      <td>60.287500</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>49.000000</td>
      <td>93.500000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>80.000000</td>
      <td>512.329200</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">Second</th>
      <th>count</th>
      <td>173.000000</td>
      <td>184.000000</td>
      <td>184.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>29.877630</td>
      <td>20.662183</td>
      <td>0.472826</td>
    </tr>
    <tr>
      <th>std</th>
      <td>14.001077</td>
      <td>13.417399</td>
      <td>0.500623</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.670000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>23.000000</td>
      <td>13.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>29.000000</td>
      <td>14.250000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>36.000000</td>
      <td>26.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>70.000000</td>
      <td>73.500000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">Third</th>
      <th>count</th>
      <td>355.000000</td>
      <td>491.000000</td>
      <td>491.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>25.140620</td>
      <td>13.675550</td>
      <td>0.242363</td>
    </tr>
    <tr>
      <th>std</th>
      <td>12.495398</td>
      <td>11.778142</td>
      <td>0.428949</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.420000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>18.000000</td>
      <td>7.750000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>24.000000</td>
      <td>8.050000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>32.000000</td>
      <td>15.500000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>74.000000</td>
      <td>69.550000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 필터링 : age열의 데이터 평균이 30보다 작은 그룹만을 필터링하여 출력
age_filter = grouped.apply(lambda x: x.age.mean()<30)
print(age_filter)
print('\n')
for x in age_filter.index:
    if age_filter[x] == True:               
        age_filter_df = grouped.get_group(x)
        print(age_filter_df.head())
        print('\n')
# 조건에 맞는 second, third그룹만 출력된 것 확인!
```

    class
    First     False
    Second     True
    Third      True
    dtype: bool
    
    
         age     sex   class     fare  survived
    9   14.0  female  Second  30.0708         1
    15  55.0  female  Second  16.0000         1
    17   NaN    male  Second  13.0000         1
    20  35.0    male  Second  26.0000         0
    21  34.0    male  Second  13.0000         1
    
    
        age     sex  class     fare  survived
    0  22.0    male  Third   7.2500         0
    2  26.0  female  Third   7.9250         1
    4  35.0    male  Third   8.0500         0
    5   NaN    male  Third   8.4583         0
    7   2.0    male  Third  21.0750         0
    
    
    
